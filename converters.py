import atexit
import os
import re
import spacy
from spacy.lang.char_classes import ALPHA, ALPHA_LOWER, ALPHA_UPPER
from spacy.lang.char_classes import CONCAT_QUOTES, LIST_ELLIPSES, LIST_ICONS
from spacy.util import compile_suffix_regex

import ujson
from g2p_en import G2p
from nltk import word_tokenize
from nltk.tokenize.treebank import TreebankWordDetokenizer
from pyclts import CLTS
from pyphonetics import Soundex, RefinedSoundex, Metaphone

from clean_ff import clean_cond, clean


def dump_with_message(msg, cache_loaded, cache_changed, obj, file_path, **kwargs):
    if cache_loaded and cache_changed:
        print(msg)
        with open(file_path, 'w') as fp:
            ujson.dump(obj, fp, **kwargs)


def persistent_cache(func):
    """
    Persistent cache decorator.
    Creates a "cache/" directory if it does not exist and writes the
    caches of the given func to the file "cache/<func-name>.cache" once
    on exit.
    """
    file_path = os.path.join('cache', f'{func.__name__}.cache')
    os.makedirs(os.path.dirname(file_path), exist_ok=True)
    try:
        print(f'Loading {file_path}')
        with open(file_path, 'r') as fp:
            cache = ujson.load(fp)
    except (IOError, ValueError):
        cache = {}
    atexit.register(lambda: dump_with_message(f'Writing {file_path}',
                                              True,
                                              True,
                                              cache,
                                              file_path,
                                              indent=4))

    def wrapper(*args):
        if str(args) not in cache:
            cache[str(args)] = func(*args)
        return cache[str(args)]

    return wrapper


clts = CLTS(os.path.join('ba-util', 'clts'))

inner_g2p_en = G2p()


def g2p_en(verbatim):
    verbatim = re.sub(re.compile(r'[0-9]{37,}'), '', verbatim)
    return inner_g2p_en(verbatim)


nlp_no_apostrophe_split = spacy.load('en_core_web_sm', exclude=['parser', 'ner'])
nlp_no_apostrophe_split.tokenizer.rules = {key: value for key, value in nlp_no_apostrophe_split.tokenizer.rules.items() if "'" not in key and "’" not in key and "‘" not in key}
suffixes = [suffix for suffix in nlp_no_apostrophe_split.Defaults.suffixes if suffix not in ["'s", "'S", '’s', '’S']]
suffix_regex = spacy.util.compile_suffix_regex(suffixes)
nlp_no_apostrophe_split.tokenizer.suffix_search = suffix_regex.search
nlp = spacy.load('en_core_web_sm', exclude=['parser', 'ner'])
nlp.tokenizer.suffix_search = suffix_regex.search

# print(nlp.Defaults.suffixes)
# Remove apostrophe rules, so tokens like "I'm" are not split up


# Arpabet to IPA dict with stress
arpabet2ipa_orig = {'AA': 'ɑ', 'AE': 'æ', 'AH': 'ʌ', 'AO': 'ɔ', 'AW': 'aʊ', 'AX': 'ə', 'AXR': 'ɚ', 'AY': 'aɪ',
                    'EH': 'ɛ', 'ER': 'ɝ', 'EY': 'eɪ', 'IH': 'ɪ', 'IX': 'ɨ', 'IY': 'i', 'OW': 'oʊ', 'OY': 'ɔɪ',
                    'UH': 'ʊ', 'UW': 'u', 'UX': 'ʉ', 'B': 'b', 'CH': 'tʃ', 'D': 'd', 'DH': 'ð', 'DX': 'ɾ', 'EL': 'l̩',
                    'EM': 'm̩', 'EN': 'n̩', 'F': 'f', 'G': 'ɡ', 'HH': 'h', 'H': 'h', 'JH': 'dʒ', 'K': 'k', 'L': 'l',
                    'M': 'm', 'N': 'n', 'NG': 'ŋ', 'NX': 'ɾ̃', 'P': 'p', 'Q': 'ʔ', 'R': 'ɹ', 'S': 's', 'SH': 'ʃ',
                    'T': 't', 'TH': 'θ', 'V': 'v', 'W': 'w', 'WH': 'ʍ', 'Y': 'j', 'Z': 'z', 'ZH': 'ʒ'}
primary_stress = {key + '1': 'ˈ' + value for key, value in arpabet2ipa_orig.items()}
secondary_stress = {key + '0': 'ˌ' + value for key, value in arpabet2ipa_orig.items()}
arpabet2ipa = {**arpabet2ipa_orig, **primary_stress, **secondary_stress}

# Arpabet to IPA dict without stress
no_primary_stress = {key + '1': value for key, value in arpabet2ipa_orig.items()}
no_secondary_stress = {key + '0': value for key, value in arpabet2ipa_orig.items()}
no_tertiary_stress = {key + '2': value for key, value in arpabet2ipa_orig.items()}
arpabet2ipa_no_stress = {**arpabet2ipa_orig, **no_primary_stress, **no_secondary_stress, **no_tertiary_stress}

soundex = Soundex()
refsoundex = RefinedSoundex()
metaphone = Metaphone()

detokenizer = TreebankWordDetokenizer()


def g2p_pyphonetics(verbatim, transcription_model):
    transcribed_tokens = []
    tokens = word_tokenize(verbatim)
    for token in tokens:
        if token.upper().isupper():
            transcribed_tokens.append(transcription_model.phonetics(token))
        else:
            transcribed_tokens.append(token)
    # transcription = detokenizer.detokenize(transcribed_tokens)
    transcription = ' '.join(transcribed_tokens)
    return transcription


# Init sound classes
sc = {
    'asjp': clts.soundclass('asjp'),
    'cv': clts.soundclass('cv'),
    'dolgo': clts.soundclass('dolgo')
}


@persistent_cache
def clts_translate(symbol, sound_class_system):
    return clts.bipa.translate(symbol, sc[sound_class_system])


whitespaces_regex = re.compile(r"\s+")


def ipa2sc(ipa_transcription, sound_class_system='dolgo'):
    """
    Takes an IPA transcribed, phoneme segmented string and replaces each
    phoneme to its corresponding sound class declared in 
    sound_class_system.
    Keeps punctuation where applicable.
    sound_class_system in {'art', 'asjp', 'color', 'cv', 'dolgo', 'sca'}
    """
    # Arpabet to IPA and tag s = symbol, p = punctuation
    char_ipa = [(arpabet2ipa_no_stress[symbol], 's') if symbol in arpabet2ipa_no_stress.keys() else (symbol, 'p') for
                symbol in ipa_transcription]
    char_sound_class = ''.join(
        [clts_translate(symbol, sound_class_system) if tag == 's' else ' ' for symbol, tag in char_ipa])
    # char_sound_class = ''.join(
    #     [clts_translate(symbol, sound_class_system) if tag == 's' else ' ' for symbol, tag in char_ipa])
    return whitespaces_regex.sub(' ', char_sound_class).strip()


# @profile
def transcribe_horizontal(verbatim):
    """
    Transcribes a given text into all transcriptions from 
    available_transcriptions(). Returns a dict with the keys being the
    corresponding transcription system names.
    """
    transcriptions = dict()

    doc_no_apostrophe_split = nlp_no_apostrophe_split(verbatim.strip())
    doc = nlp(verbatim.strip())
    # Verbatim
    transcriptions['verbatim'] = clean(doc)

    # Create miscellaneous transcriptions
    # transcriptions['punct'] = ' '.join([token.text for token in doc_no_apostrophe_split if any(c.isalpha() for c in token.text)])
    transcriptions['punct'] = ' '.join([token.text.lower()
                                        for token in doc_no_apostrophe_split
                                        if not token.is_punct
                                        and clean_cond(token)])
    transcriptions['punct_lemma'] = ' '.join([token.lemma_
                                              for token in doc
                                              if not token.is_punct
                                              and clean_cond(token)])
    transcriptions['punct_lemma_stop'] = ' '.join([token.lemma_
                                                   for token in doc
                                                   if (not token.is_stop
                                                       and not token.is_punct)
                                                       and clean_cond(token)])

    # Create IPA transcription
    ipa_transcription = ''
    phonemes = g2p_en(transcriptions['verbatim'])
    for symbol in phonemes:
        if symbol in arpabet2ipa_no_stress.keys():
            ipa_transcription += arpabet2ipa_no_stress[symbol]
        elif symbol == ' ' and not ipa_transcription.endswith(' '):
            ipa_transcription += symbol
    transcriptions['ipa'] = ipa_transcription

    # Create Sound Class transcriptions, reusing IPA transcriptions
    for sound_class in {'cv', 'dolgo', 'asjp'}:
        transcriptions[sound_class] = ipa2sc(phonemes, sound_class)

    # Create Soundex transcriptions
    transcriptions['soundex'] = ' '.join([soundex.phonetics(token.text) for token in doc_no_apostrophe_split if any(c.isalpha() for c in token.text) and clean_cond(token)])
    transcriptions['refsoundex'] = ' '.join([refsoundex.phonetics(token.text) for token in doc_no_apostrophe_split if any(c.isalpha() for c in token.text) and clean_cond(token)])
    transcriptions['metaphone'] = ' '.join([metaphone.phonetics(token.text) for token in doc_no_apostrophe_split if any(c.isalpha() for c in token.text) and clean_cond(token)])

    return transcriptions

alphabet = [
        "!",
        "\"",
        "#",
        "$",
        "%",
        "&",
        "'",
        "(",
        ")",
        "*",
        "+",
        ",",
        "-",
        ".",
        "/",
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7",
        "8",
        "9",
        ":",
        ";",
        "<",
        "=",
        ">",
        "?",
        "@",
        "[",
        "\\",
        "]",
        "^",
        "_",
        "`",
        "a",
        "b",
        "c",
        "d",
        "e",
        "f",
        "g",
        "h",
        "i",
        "j",
        "k",
        "l",
        "m",
        "n",
        "o",
        "p",
        "q",
        "r",
        "s",
        "t",
        "u",
        "v",
        "w",
        "x",
        "y",
        "z",
        "{",
        "|",
        "}",
        "~",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "¡",
        "¢",
        "£",
        "¤",
        "¥",
        "§",
        "¬",
        "­",
        "±",
        "¶",
        "·",
        "¿",
        "×",
        "ß",
        "à",
        "á",
        "â",
        "ã",
        "ä",
        "å",
        "æ",
        "ç",
        "è",
        "é",
        "ê",
        "ë",
        "ì",
        "í",
        "î",
        "ï",
        "ð",
        "ñ",
        "ò",
        "ó",
        "ô",
        "õ",
        "ö",
        "÷",
        "ø",
        "ù",
        "ú",
        "û",
        "ü",
        "ý",
        "þ",
        "ÿ",
        "ā",
        "ă",
        "ą",
        "ć",
        "ĉ",
        "č",
        "ď",
        "đ",
        "ē",
        "ĕ",
        "ė",
        "ę",
        "ě",
        "ĝ",
        "ğ",
        "ġ",
        "ĥ",
        "ħ",
        "ī",
        "ĭ",
        "į",
        "ı",
        "ĸ",
        "ĺ",
        "ļ",
        "ľ",
        "ł",
        "ń",
        "ņ",
        "ň",
        "ō",
        "ŏ",
        "ő",
        "œ",
        "ŕ",
        "ŗ",
        "ř",
        "ś",
        "ŝ",
        "ş",
        "š",
        "ţ",
        "ť",
        "ŧ",
        "ũ",
        "ū",
        "ŭ",
        "ů",
        "ű",
        "ų",
        "ŵ",
        "ŷ",
        "ź",
        "ż",
        "ž",
        "ƃ",
        "ƒ",
        "ƛ",
        "ơ",
        "ƨ",
        "ư",
        "ƹ",
        "ǃ",
        "ǎ",
        "ǐ",
        "ǒ",
        "ǔ",
        "ǘ",
        "ǝ",
        "ǧ",
        "ǫ",
        "ǵ",
        "ǹ",
        "ǻ",
        "ǽ",
        "ǿ",
        "ȁ",
        "ȅ",
        "ȇ",
        "ȉ",
        "ȋ",
        "ȍ",
        "ȏ",
        "ȓ",
        "ș",
        "ț",
        "ȟ",
        "ȧ",
        "ȩ",
        "ȫ",
        "ȯ",
        "ȳ",
        "ȷ",
        "ɐ",
        "ɔ",
        "ə",
        "ɛ",
        "ɟ",
        "ɥ",
        "ɪ",
        "ɯ",
        "ɴ",
        "ɷ",
        "ɸ",
        "ɹ",
        "ʀ",
        "ʇ",
        "ʋ",
        "ʍ",
        "ʎ",
        "ʏ",
        "ʒ",
        "ʕ",
        "ʘ",
        "ʜ",
        "ʞ",
        "ʟ",
        "ʹ",
        "ʺ",
        "ʻ",
        "ʼ",
        "ʽ",
        "ʿ",
        "˂",
        "˃",
        "ˆ",
        "ˇ",
        "ˈ",
        "ˌ",
        "ː",
        "ˮ",
        "˳",
        "˹",
        "˼",
        "̀",
        "́",
        "̂",
        "̃",
        "̄",
        "̅",
        "̆",
        "̇",
        "̈",
        "̉",
        "̊",
        "̋",
        "̌",
        "̍",
        "̎",
        "̏",
        "̐",
        "̑",
        "̒",
        "̓",
        "̔",
        "̕",
        "̖",
        "̗",
        "̘",
        "̙",
        "̚",
        "̛",
        "̜",
        "̝",
        "̞",
        "̟",
        "̠",
        "̡",
        "̢",
        "̣",
        "̤",
        "̥",
        "̦",
        "̧",
        "̨",
        "̩",
        "̪",
        "̫",
        "̬",
        "̭",
        "̮",
        "̯",
        "̰",
        "̱",
        "̲",
        "̳",
        "̴",
        "̵",
        "̶",
        "̷",
        "̸",
        "̹",
        "̺",
        "̻",
        "̼",
        "̽",
        "̾",
        "̿",
        "͂",
        "ͅ",
        "͆",
        "͇",
        "͈",
        "͉",
        "͊",
        "͋",
        "͌",
        "͍",
        "͎",
        "͏",
        "͐",
        "͑",
        "͒",
        "͓",
        "͔",
        "͕",
        "͖",
        "͗",
        "͘",
        "͙",
        "͚",
        "͛",
        "͜",
        "͝",
        "͞",
        "͟",
        "͠",
        "͡",
        "͢",
        "ͣ",
        "ͤ",
        "ͥ",
        "ͦ",
        "ͧ",
        "ͨ",
        "ͩ",
        "ͪ",
        "ͫ",
        "ͬ",
        "ͭ",
        "ͮ",
        "ͯ",
        "ͼ",
        "ά",
        "έ",
        "ή",
        "ί",
        "α",
        "β",
        "γ",
        "δ",
        "ε",
        "ζ",
        "η",
        "θ",
        "ι",
        "κ",
        "λ",
        "μ",
        "ν",
        "ξ",
        "ο",
        "π",
        "ρ",
        "ς",
        "σ",
        "τ",
        "υ",
        "φ",
        "χ",
        "ψ",
        "ω",
        "ϊ",
        "ό",
        "ύ",
        "ώ",
        "ϛ",
        "ϟ",
        "ϡ",
        "ϩ",
        "а",
        "б",
        "в",
        "г",
        "д",
        "е",
        "ж",
        "з",
        "и",
        "й",
        "к",
        "л",
        "м",
        "н",
        "о",
        "п",
        "р",
        "с",
        "т",
        "у",
        "ф",
        "х",
        "ц",
        "ч",
        "ш",
        "щ",
        "ъ",
        "ы",
        "ь",
        "э",
        "ю",
        "я",
        "ѐ",
        "ё",
        "ѓ",
        "є",
        "ѕ",
        "і",
        "ї",
        "ј",
        "љ",
        "ћ",
        "ў",
        "ѡ",
        "ѫ",
        "҉",
        "ғ",
        "қ",
        "ҝ",
        "ӂ",
        "ӓ",
        "ӝ",
        "՞",
        "ա",
        "գ",
        "դ",
        "ե",
        "է",
        "ի",
        "լ",
        "կ",
        "ձ",
        "մ",
        "յ",
        "ն",
        "ո",
        "պ",
        "ս",
        "տ",
        "ր",
        "ւ",
        "ք",
        "֊",
        "֒",
        "ְ",
        "ֱ",
        "ֲ",
        "ִ",
        "ֵ",
        "ֶ",
        "ַ",
        "ָ",
        "ֹ",
        "ּ",
        "ׁ",
        "ׂ",
        "א",
        "ב",
        "ג",
        "ד",
        "ה",
        "ו",
        "ז",
        "ח",
        "ט",
        "י",
        "ך",
        "כ",
        "ל",
        "ם",
        "מ",
        "ן",
        "נ",
        "ס",
        "ע",
        "ף",
        "פ",
        "ץ",
        "צ",
        "ק",
        "ר",
        "ש",
        "ת",
        "؟",
        "ء",
        "أ",
        "إ",
        "ئ",
        "ا",
        "ب",
        "ة",
        "ت",
        "ث",
        "ج",
        "ح",
        "خ",
        "د",
        "ذ",
        "ر",
        "ز",
        "س",
        "ش",
        "ص",
        "ض",
        "ط",
        "ظ",
        "ع",
        "غ",
        "ف",
        "ق",
        "ك",
        "ل",
        "م",
        "ن",
        "ه",
        "و",
        "ى",
        "ي",
        "ً",
        "ُ",
        "پ",
        "چ",
        "ډ",
        "گ",
        "ۆ",
        "ۍ",
        "ێ",
        "ە",
        "۶",
        "ँ",
        "ं",
        "अ",
        "आ",
        "ए",
        "ओ",
        "औ",
        "क",
        "ख",
        "ग",
        "ज",
        "झ",
        "त",
        "थ",
        "द",
        "ध",
        "न",
        "प",
        "ब",
        "म",
        "य",
        "र",
        "ल",
        "व",
        "श",
        "ष",
        "स",
        "ह",
        "ा",
        "ि",
        "ी",
        "ु",
        "ू",
        "ृ",
        "े",
        "ै",
        "ो",
        "ौ",
        "्",
        "আ",
        "ই",
        "এ",
        "ক",
        "খ",
        "ট",
        "ত",
        "ন",
        "প",
        "ব",
        "ম",
        "য",
        "র",
        "ল",
        "হ",
        "়",
        "া",
        "ি",
        "ে",
        "ো",
        "্",
        "৲",
        "ં",
        "અ",
        "એ",
        "ક",
        "ખ",
        "ગ",
        "જ",
        "ત",
        "થ",
        "ન",
        "મ",
        "ર",
        "લ",
        "વ",
        "શ",
        "હ",
        "ા",
        "ી",
        "ુ",
        "ે",
        "ો",
        "્",
        "ஓ",
        "ஜ",
        "ಠ",
        "ಸ",
        "ก",
        "ข",
        "ค",
        "ฅ",
        "ง",
        "จ",
        "ณ",
        "ถ",
        "ท",
        "น",
        "บ",
        "ม",
        "ย",
        "ร",
        "ว",
        "ส",
        "ห",
        "อ",
        "ะ",
        "ั",
        "า",
        "ี",
        "ุ",
        "ู",
        "เ",
        "ใ",
        "ไ",
        "่",
        "้",
        "ํ",
        "๑",
        "ຶ",
        "༼",
        "༽",
        "ཀ",
        "ა",
        "ბ",
        "დ",
        "ე",
        "ვ",
        "თ",
        "ი",
        "ლ",
        "მ",
        "ნ",
        "ო",
        "რ",
        "ს",
        "ღ",
        "შ",
        "წ",
        "ხ",
        "ᄁ",
        "ᄇ",
        "ᄋ",
        "ᄌ",
        "ᄑ",
        "ᄒ",
        "ᄡ",
        "ᅠ",
        "ᅡ",
        "ᅩ",
        "ᅲ",
        "ᅳ",
        "ᆺ",
        "ᐛ",
        "ᕕ",
        "ᕗ",
        "ᕤ",
        "ᕦ",
        "ᗒ",
        "ᗕ",
        "ᗨ",
        "ᗩ",
        "ᚡ",
        "ᚨ",
        "ᚱ",
        "ᚹ",
        "ᚺ",
        "ᛃ",
        "ᛒ",
        "ᛖ",
        "ᛚ",
        "ᛞ",
        "ᠠ",
        "ᠢ",
        "ᠨ",
        "ᠩ",
        "ᠪ",
        "ᠴ",
        "ᠵ",
        "ᠷ",
        "ᡝ",
        "ᡠ",
        "ᡤ",
        "ᡩ",
        "ᡳ",
        "ᴀ",
        "ᴇ",
        "ᴈ",
        "ᴉ",
        "ᴍ",
        "ᴏ",
        "ᴗ",
        "ᴛ",
        "ᴡ",
        "ᵎ",
        "ᵯ",
        "ḁ",
        "ḋ",
        "ḍ",
        "ḑ",
        "ḓ",
        "ḙ",
        "ḛ",
        "ḣ",
        "ḥ",
        "ḧ",
        "ḩ",
        "ḫ",
        "ḭ",
        "ḯ",
        "ḷ",
        "ḻ",
        "ḽ",
        "ḿ",
        "ṁ",
        "ṃ",
        "ṅ",
        "ṇ",
        "ṛ",
        "ṟ",
        "ṡ",
        "ṣ",
        "ṩ",
        "ṫ",
        "ṭ",
        "ṯ",
        "ṱ",
        "ṳ",
        "ṷ",
        "ṻ",
        "ṽ",
        "ṿ",
        "ẁ",
        "ẃ",
        "ẇ",
        "ẍ",
        "ẖ",
        "ẗ",
        "ẘ",
        "ạ",
        "ầ",
        "ậ",
        "ẹ",
        "ẻ",
        "ẽ",
        "ế",
        "ị",
        "ọ",
        "ỏ",
        "ộ",
        "ớ",
        "ờ",
        "ở",
        "ủ",
        "ỳ",
        "ỵ",
        "ỷ",
        "ἄ",
        "ἅ",
        "ἠ",
        "ῆ",
        "ῡ",
        "​",
        "‎",
        "‐",
        "―",
        "‚",
        "‛",
        "†",
        "‡",
        "•",
        "‰",
        "′",
        "‽",
        "⁄",
        "⁎",
        "€",
        "←",
        "→",
        "↓",
        "⇔",
        "∀",
        "∂",
        "∇",
        "∑",
        "−",
        "√",
        "∞",
        "∩",
        "∪",
        "∫",
        "≈",
        "≖",
        "≠",
        "≦",
        "≧",
        "⊂",
        "⊃",
        "⌠",
        "、",
        "。",
        "々",
        "「",
        "」",
        "【",
        "】",
        "〜",
        "あ",
        "い",
        "う",
        "え",
        "お",
        "か",
        "が",
        "き",
        "ぎ",
        "く",
        "ぐ",
        "け",
        "げ",
        "こ",
        "ご",
        "さ",
        "ざ",
        "し",
        "じ",
        "す",
        "ず",
        "せ",
        "ぜ",
        "そ",
        "ぞ",
        "た",
        "だ",
        "ち",
        "っ",
        "つ",
        "づ",
        "て",
        "で",
        "と",
        "ど",
        "な",
        "に",
        "ぬ",
        "ね",
        "の",
        "は",
        "ば",
        "ぱ",
        "ひ",
        "び",
        "ふ",
        "ぶ",
        "へ",
        "べ",
        "ほ",
        "ぼ",
        "ま",
        "み",
        "む",
        "め",
        "も",
        "ゃ",
        "や",
        "ゅ",
        "ゆ",
        "ょ",
        "よ",
        "ら",
        "り",
        "る",
        "れ",
        "ろ",
        "わ",
        "を",
        "ん",
        "゚",
        "ゞ",
        "ァ",
        "ア",
        "ィ",
        "イ",
        "ウ",
        "ェ",
        "エ",
        "ォ",
        "オ",
        "カ",
        "ガ",
        "キ",
        "ク",
        "グ",
        "ケ",
        "コ",
        "ゴ",
        "サ",
        "ザ",
        "シ",
        "ジ",
        "ス",
        "ズ",
        "セ",
        "ソ",
        "ゾ",
        "タ",
        "ダ",
        "チ",
        "ッ",
        "ツ",
        "テ",
        "デ",
        "ト",
        "ド",
        "ナ",
        "ニ",
        "ノ",
        "ハ",
        "バ",
        "パ",
        "ヒ",
        "ビ",
        "ピ",
        "フ",
        "ブ",
        "プ",
        "ヘ",
        "ベ",
        "ペ",
        "ホ",
        "ボ",
        "ポ",
        "マ",
        "ミ",
        "ム",
        "メ",
        "モ",
        "ャ",
        "ヤ",
        "ュ",
        "ユ",
        "ョ",
        "ヨ",
        "ラ",
        "リ",
        "ル",
        "レ",
        "ロ",
        "ヮ",
        "ワ",
        "ン",
        "ヴ",
        "・",
        "ー",
        "ヽ",
        "ヾ",
        "一",
        "丁",
        "七",
        "丈",
        "三",
        "上",
        "下",
        "不",
        "与",
        "世",
        "丘",
        "両",
        "並",
        "个",
        "中",
        "丸",
        "丹",
        "主",
        "么",
        "之",
        "九",
        "也",
        "书",
        "乱",
        "了",
        "争",
        "事",
        "二",
        "于",
        "云",
        "互",
        "井",
        "亡",
        "交",
        "人",
        "什",
        "今",
        "他",
        "仗",
        "付",
        "代",
        "令",
        "以",
        "们",
        "仮",
        "伊",
        "休",
        "伙",
        "会",
        "伝",
        "伴",
        "伽",
        "位",
        "住",
        "体",
        "何",
        "作",
        "你",
        "使",
        "來",
        "供",
        "便",
        "俄",
        "保",
        "信",
        "個",
        "們",
        "倒",
        "倫",
        "停",
        "側",
        "備",
        "傷",
        "働",
        "像",
        "僕",
        "儀",
        "優",
        "元",
        "兄",
        "先",
        "光",
        "児",
        "党",
        "入",
        "全",
        "八",
        "公",
        "六",
        "共",
        "关",
        "兵",
        "典",
        "兽",
        "内",
        "円",
        "再",
        "冗",
        "写",
        "冠",
        "冬",
        "凍",
        "凛",
        "凝",
        "出",
        "刁",
        "刃",
        "分",
        "切",
        "刈",
        "列",
        "初",
        "別",
        "利",
        "到",
        "制",
        "刻",
        "前",
        "剑",
        "剣",
        "割",
        "力",
        "助",
        "動",
        "勛",
        "勝",
        "勞",
        "包",
        "化",
        "北",
        "区",
        "十",
        "千",
        "単",
        "卜",
        "卡",
        "印",
        "即",
        "厌",
        "厚",
        "原",
        "去",
        "参",
        "叉",
        "及",
        "友",
        "取",
        "受",
        "变",
        "口",
        "古",
        "叩",
        "叫",
        "可",
        "台",
        "右",
        "号",
        "司",
        "合",
        "吉",
        "同",
        "名",
        "向",
        "吗",
        "君",
        "含",
        "吸",
        "吻",
        "呆",
        "告",
        "味",
        "呼",
        "命",
        "和",
        "咸",
        "哈",
        "員",
        "哦",
        "哪",
        "哲",
        "唄",
        "唇",
        "唯",
        "啊",
        "問",
        "喝",
        "嘲",
        "器",
        "噴",
        "囁",
        "四",
        "回",
        "因",
        "団",
        "困",
        "囲",
        "固",
        "園",
        "土",
        "圧",
        "在",
        "地",
        "坊",
        "坐",
        "域",
        "報",
        "場",
        "境",
        "壁",
        "壊",
        "士",
        "声",
        "変",
        "夏",
        "夕",
        "外",
        "多",
        "夜",
        "夢",
        "大",
        "天",
        "太",
        "夫",
        "失",
        "奮",
        "女",
        "奴",
        "她",
        "好",
        "如",
        "妖",
        "妙",
        "妹",
        "姉",
        "始",
        "姐",
        "姜",
        "姫",
        "威",
        "娘",
        "媽",
        "子",
        "孔",
        "存",
        "学",
        "它",
        "宅",
        "守",
        "安",
        "完",
        "宙",
        "定",
        "実",
        "室",
        "害",
        "家",
        "容",
        "宿",
        "寂",
        "富",
        "寒",
        "寛",
        "寝",
        "寧",
        "寫",
        "对",
        "寺",
        "导",
        "対",
        "専",
        "将",
        "尊",
        "尋",
        "導",
        "小",
        "少",
        "屈",
        "届",
        "屋",
        "展",
        "属",
        "山",
        "岸",
        "崇",
        "崎",
        "嶋",
        "川",
        "工",
        "巴",
        "巻",
        "希",
        "带",
        "師",
        "席",
        "帰",
        "常",
        "幫",
        "平",
        "年",
        "幸",
        "幹",
        "幼",
        "広",
        "床",
        "底",
        "度",
        "庫",
        "庭",
        "康",
        "延",
        "建",
        "式",
        "引",
        "弘",
        "弟",
        "張",
        "強",
        "弾",
        "当",
        "彡",
        "形",
        "影",
        "彼",
        "待",
        "後",
        "徐",
        "徒",
        "従",
        "得",
        "復",
        "微",
        "徹",
        "心",
        "必",
        "忍",
        "志",
        "忘",
        "快",
        "念",
        "怎",
        "怒",
        "怖",
        "思",
        "急",
        "性",
        "怪",
        "恋",
        "恐",
        "息",
        "恶",
        "悠",
        "您",
        "悩",
        "悪",
        "情",
        "惊",
        "惑",
        "想",
        "意",
        "愛",
        "感",
        "慢",
        "憎",
        "應",
        "成",
        "我",
        "戦",
        "戸",
        "戻",
        "所",
        "扉",
        "手",
        "才",
        "打",
        "承",
        "投",
        "折",
        "抜",
        "抱",
        "押",
        "担",
        "拉",
        "拍",
        "拝",
        "括",
        "拾",
        "持",
        "指",
        "挫",
        "振",
        "授",
        "掛",
        "接",
        "推",
        "描",
        "換",
        "揮",
        "揺",
        "損",
        "搭",
        "撃",
        "撮",
        "擁",
        "操",
        "攻",
        "政",
        "救",
        "敗",
        "教",
        "散",
        "数",
        "敵",
        "文",
        "料",
        "斯",
        "新",
        "方",
        "於",
        "斿",
        "旅",
        "族",
        "既",
        "日",
        "早",
        "昇",
        "明",
        "星",
        "映",
        "昨",
        "是",
        "昼",
        "時",
        "晕",
        "晩",
        "普",
        "晶",
        "暖",
        "暮",
        "曜",
        "曲",
        "書",
        "曾",
        "替",
        "最",
        "會",
        "月",
        "有",
        "朋",
        "服",
        "朔",
        "望",
        "朝",
        "木",
        "未",
        "本",
        "李",
        "村",
        "条",
        "来",
        "東",
        "松",
        "林",
        "枢",
        "架",
        "柄",
        "柔",
        "柴",
        "校",
        "桐",
        "桜",
        "梅",
        "械",
        "棒",
        "森",
        "検",
        "楊",
        "業",
        "楼",
        "楽",
        "構",
        "様",
        "横",
        "樹",
        "橋",
        "橙",
        "機",
        "櫻",
        "欠",
        "次",
        "欺",
        "歌",
        "歡",
        "止",
        "正",
        "此",
        "武",
        "歩",
        "歯",
        "死",
        "残",
        "段",
        "殺",
        "母",
        "毛",
        "気",
        "水",
        "求",
        "決",
        "沈",
        "沒",
        "沢",
        "沼",
        "法",
        "波",
        "注",
        "洗",
        "洞",
        "活",
        "派",
        "流",
        "浄",
        "浴",
        "海",
        "消",
        "淡",
        "深",
        "混",
        "添",
        "清",
        "渇",
        "測",
        "準",
        "溜",
        "溢",
        "溶",
        "溺",
        "滅",
        "滞",
        "滴",
        "漫",
        "潤",
        "潮",
        "潰",
        "澄",
        "火",
        "災",
        "点",
        "為",
        "烦",
        "無",
        "焼",
        "熟",
        "熱",
        "燃",
        "燠",
        "爆",
        "父",
        "片",
        "版",
        "牛",
        "物",
        "特",
        "犬",
        "犯",
        "狐",
        "狼",
        "獅",
        "獣",
        "玄",
        "率",
        "玉",
        "王",
        "现",
        "現",
        "球",
        "理",
        "琴",
        "環",
        "甘",
        "生",
        "用",
        "田",
        "由",
        "甲",
        "男",
        "町",
        "画",
        "界",
        "畏",
        "略",
        "番",
        "異",
        "當",
        "病",
        "痛",
        "発",
        "發",
        "白",
        "百",
        "的",
        "皆",
        "皮",
        "皿",
        "益",
        "盟",
        "監",
        "目",
        "直",
        "相",
        "省",
        "真",
        "眠",
        "着",
        "知",
        "短",
        "破",
        "硫",
        "確",
        "示",
        "礼",
        "祖",
        "祝",
        "神",
        "票",
        "祭",
        "福",
        "秀",
        "私",
        "秋",
        "科",
        "秒",
        "移",
        "程",
        "穏",
        "穴",
        "空",
        "穿",
        "突",
        "窟",
        "立",
        "竜",
        "章",
        "端",
        "笑",
        "笠",
        "第",
        "筆",
        "筈",
        "答",
        "箱",
        "篠",
        "米",
        "精",
        "糖",
        "系",
        "約",
        "紅",
        "純",
        "紙",
        "素",
        "紡",
        "紫",
        "紺",
        "終",
        "組",
        "結",
        "絡",
        "統",
        "絶",
        "継",
        "続",
        "維",
        "緒",
        "線",
        "締",
        "編",
        "縁",
        "繁",
        "繊",
        "繋",
        "織",
        "繭",
        "繰",
        "罗",
        "罪",
        "置",
        "罵",
        "美",
        "群",
        "義",
        "羽",
        "翻",
        "翼",
        "老",
        "考",
        "者",
        "耳",
        "聖",
        "聞",
        "聴",
        "肉",
        "肌",
        "肩",
        "育",
        "背",
        "胸",
        "能",
        "脉",
        "脳",
        "腕",
        "腰",
        "臥",
        "臨",
        "自",
        "致",
        "興",
        "舗",
        "舞",
        "良",
        "色",
        "花",
        "若",
        "苦",
        "茶",
        "草",
        "華",
        "落",
        "葉",
        "著",
        "葵",
        "蒼",
        "蓮",
        "薄",
        "薙",
        "藍",
        "藏",
        "藤",
        "虎",
        "虐",
        "蛍",
        "蜃",
        "蟬",
        "血",
        "衆",
        "行",
        "術",
        "衝",
        "衣",
        "表",
        "袋",
        "袖",
        "裂",
        "補",
        "西",
        "要",
        "見",
        "視",
        "覚",
        "親",
        "见",
        "解",
        "触",
        "言",
        "計",
        "記",
        "許",
        "訳",
        "訴",
        "詐",
        "試",
        "詩",
        "話",
        "該",
        "誇",
        "誌",
        "認",
        "誓",
        "誕",
        "語",
        "誠",
        "説",
        "読",
        "誰",
        "調",
        "談",
        "請",
        "謝",
        "讓",
        "讨",
        "论",
        "评",
        "诉",
        "说",
        "请",
        "谢",
        "豪",
        "貂",
        "貫",
        "質",
        "贅",
        "赤",
        "走",
        "起",
        "超",
        "越",
        "足",
        "距",
        "踊",
        "蹴",
        "身",
        "車",
        "載",
        "辦",
        "込",
        "迎",
        "近",
        "返",
        "这",
        "述",
        "追",
        "退",
        "送",
        "逆",
        "這",
        "通",
        "速",
        "造",
        "連",
        "進",
        "遅",
        "遊",
        "運",
        "過",
        "道",
        "達",
        "違",
        "遣",
        "選",
        "避",
        "還",
        "邸",
        "郎",
        "部",
        "郭",
        "郵",
        "都",
        "鄭",
        "酉",
        "配",
        "酬",
        "醒",
        "采",
        "里",
        "重",
        "野",
        "量",
        "金",
        "鈴",
        "鉄",
        "銃",
        "鋼",
        "録",
        "鐘",
        "長",
        "閉",
        "開",
        "間",
        "関",
        "關",
        "门",
        "阳",
        "附",
        "限",
        "陛",
        "院",
        "除",
        "陰",
        "陽",
        "階",
        "際",
        "隠",
        "隣",
        "險",
        "隸",
        "隼",
        "雑",
        "離",
        "難",
        "雨",
        "雪",
        "零",
        "電",
        "震",
        "霊",
        "露",
        "青",
        "静",
        "非",
        "面",
        "靴",
        "音",
        "韵",
        "頬",
        "頭",
        "頼",
        "題",
        "額",
        "顎",
        "顔",
        "願",
        "類",
        "風",
        "飛",
        "食",
        "餅",
        "館",
        "饅",
        "首",
        "馬",
        "駄",
        "驚",
        "骑",
        "骨",
        "髏",
        "高",
        "髪",
        "鬼",
        "魔",
        "鯉",
        "鳥",
        "鳴",
        "鶴",
        "鹿",
        "麻",
        "麼",
        "黑",
        "黒",
        "黙",
        "點",
        "鼎",
        "鼓",
        "龍",
        "龙",
        "ꈨ",
        "ꎁ",
        "가",
        "감",
        "같",
        "거",
        "게",
        "고",
        "관",
        "괜",
        "국",
        "군",
        "그",
        "금",
        "기",
        "깨",
        "꽤",
        "년",
        "녕",
        "눈",
        "는",
        "니",
        "다",
        "당",
        "대",
        "도",
        "됩",
        "드",
        "든",
        "따",
        "라",
        "람",
        "려",
        "를",
        "리",
        "립",
        "매",
        "모",
        "무",
        "미",
        "방",
        "번",
        "법",
        "봐",
        "부",
        "뷰",
        "쁜",
        "사",
        "생",
        "서",
        "선",
        "세",
        "섹",
        "션",
        "소",
        "습",
        "시",
        "신",
        "써",
        "아",
        "안",
        "어",
        "에",
        "여",
        "예",
        "오",
        "옥",
        "요",
        "우",
        "운",
        "위",
        "유",
        "은",
        "을",
        "의",
        "이",
        "인",
        "입",
        "있",
        "잊",
        "장",
        "저",
        "점",
        "제",
        "조",
        "주",
        "중",
        "지",
        "째",
        "찮",
        "참",
        "천",
        "치",
        "컷",
        "크",
        "탁",
        "탭",
        "터",
        "편",
        "하",
        "한",
        "합",
        "해",
        "행",
        "후",
        "흉",
        "희",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "️",
        "﻿"
    ]